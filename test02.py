from itertools import permutations

# ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠
straight_sales = {f"{i:03}": 0 for i in range(1000)}  # ‡πÄ‡∏•‡∏Ç‡∏ï‡∏£‡∏á
tod_sales = {f"{i:03}": 0 for i in range(1000)}       # ‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏î

def get_tod_group(number):
    """‡∏Ñ‡∏∑‡∏ô‡∏ä‡∏∏‡∏î‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏î‡∏à‡∏≤‡∏Å‡πÄ‡∏•‡∏Ç 3 ‡∏´‡∏•‡∏±‡∏Å ‡πÄ‡∏ä‡πà‡∏ô 123 -> [123, 132, 213, 231, 312, 321]"""
    return set("".join(p) for p in permutations(number))

def buy_number():
    while True:
        print("\nüìå ‡∏Å‡∏î 1 = ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏Ç | 2 = ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏Å‡∏¥‡∏ô 50 | 0 = ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö")
        choice = input("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á: ").strip()

        if choice == '0':
            print("üëã ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏°‡∏∑‡∏≠‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö")
            break

        elif choice == '1':
            number = input("‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠ (000-999): ").strip()

            if number not in straight_sales:
                print("‚ùå ‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç 000 ‡∏ñ‡∏∂‡∏á 999 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô")
                continue

            bet_type = input("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏°‡∏û‡∏±‡∏ô: '‡∏ï‡∏£‡∏á' ‡∏´‡∏£‡∏∑‡∏≠ '‡πÇ‡∏ï‡πä‡∏î': ").strip().lower()
            if bet_type not in ['‡∏ï‡∏£‡∏á', '‡πÇ‡∏ï‡πä‡∏î']:
                print("‚ùå ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô '‡∏ï‡∏£‡∏á' ‡∏´‡∏£‡∏∑‡∏≠ '‡πÇ‡∏ï‡πä‡∏î'")
                continue

            try:
                amount = int(input(f"‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏Ç {number} ({bet_type}): ").strip())
                if amount <= 0:
                    print("‚ùå ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0")
                    continue
            except ValueError:
                print("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç")
                continue

            if bet_type == '‡∏ï‡∏£‡∏á':
                straight_sales[number] += amount
                total = straight_sales[number]
                print(f"‚úÖ ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏Ç {number} ‡∏ï‡∏£‡∏á ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô {amount} ‡∏ö‡∏≤‡∏ó (‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: {total} ‡∏ö‡∏≤‡∏ó)")

                if total >= 50:
                    print(f"‚ö†Ô∏è ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡πÄ‡∏•‡∏Ç‡∏ï‡∏£‡∏á {number} ‡∏ñ‡∏π‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏ß‡∏° {total} ‡∏ö‡∏≤‡∏ó (‚â• 50)")

            else:  # ‡πÇ‡∏ï‡πä‡∏î
                tod_sales[number] += amount
                group = get_tod_group(number)
                group_total = sum(tod_sales[n] for n in group)

                print(f"‚úÖ ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏Ç {number} ‡πÇ‡∏ï‡πä‡∏î ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô {amount} ‡∏ö‡∏≤‡∏ó (‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ä‡∏∏‡∏î‡πÇ‡∏ï‡πä‡∏î: {group_total} ‡∏ö‡∏≤‡∏ó)")
                if group_total >= 50:
                    print(f"‚ö†Ô∏è ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏ä‡∏∏‡∏î‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏î‡∏Ç‡∏≠‡∏á {number} ‡∏ñ‡∏π‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏ß‡∏° {group_total} ‡∏ö‡∏≤‡∏ó (‚â• 50)")

        elif choice == '2':
            print("\nüìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏Å‡∏¥‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 50 ‡∏ö‡∏≤‡∏ó:\n")

            found = False

            # ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏•‡∏Ç‡∏ï‡∏£‡∏á
            for num, total in straight_sales.items():
                if total >= 50:
                    print(f"üî∏ ‡πÄ‡∏•‡∏Ç‡∏ï‡∏£‡∏á {num} ‡∏°‡∏µ‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠ {total} ‡∏ö‡∏≤‡∏ó")
                    found = True

            # ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏î (‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°)
            checked_groups = set()
            for num in tod_sales:
                group = frozenset(get_tod_group(num))
                if group in checked_groups:
                    continue
                group_total = sum(tod_sales[n] for n in group)
                if group_total >= 50:
                    group_str = ', '.join(sorted(group))
                    print(f"üîπ ‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏° {group_str} ‡∏°‡∏µ‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏ß‡∏° {group_total} ‡∏ö‡∏≤‡∏ó")
                    found = True
                checked_groups.add(group)

            if not found:
                print("üì≠ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏•‡∏Ç‡πÉ‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏Å‡∏¥‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 50 ‡∏ö‡∏≤‡∏ó")

        else:
            print("‚ùå ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 0, 1 ‡∏´‡∏£‡∏∑‡∏≠ 2")
buy_number()